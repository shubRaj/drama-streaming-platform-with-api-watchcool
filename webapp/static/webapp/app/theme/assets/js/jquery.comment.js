(function(){var cache={};this.tmpl=function(str,data){var fn=!/[^A-Za-z0-9_-]/.test(str)?cache[str]=cache[str]||tmpl(document.getElementById(str).innerHTML):new Function('obj',"var p=[],print=function(){p.push.apply(p,arguments);};"+
"with(obj){p.push('"+
str.replace(/[\r\t\n]/g," ").replace(/'(?=[^%]*%})/g,"\t").split("'").join("\\'").split("\t").join("'").replace(/{%=(.+?)%}/g,"',$1,'").split("{%").join("');").split("%}").join("p.push('")+
"');}return p.join('');");return data?fn(data):fn;};})();(function(factory){if(typeof define==='function'&&define.amd){define(['jquery'],factory);}else{factory(jQuery);}}(function($){$.timeago=function(timestamp){if(timestamp instanceof Date){return inWords(timestamp);}else if(typeof timestamp==="string"){return inWords($.timeago.parse(timestamp));}else if(typeof timestamp==="number"){return inWords(new Date(timestamp));}else{return inWords($.timeago.datetime(timestamp));}};var $t=$.timeago;$.extend($.timeago,{settings:{refreshMillis:60000,allowPast:true,allowFuture:false,localeTitle:false,cutoff:0,strings:{prefixAgo:null,prefixFromNow:null,suffixAgo:"Ã¶nce",suffixFromNow:"ÅŸimdi",inPast:'ÅŸimdi',seconds:"az",minute:"%d dakika",minutes:"%d dakika",hour:"%d saat",hours:"%d saat",day:"%d gÃ¼n",days:"%d gÃ¼n",month:"%d ay",months:"%d ay",year:"%d yÄ±l",years:"%d yÄ±l",wordSeparator:" ",numbers:[]}},inWords:function(distanceMillis){if(!this.settings.allowPast&&!this.settings.allowFuture){throw 'timeago allowPast and allowFuture settings can not both be set to false.';}
var $l=this.settings.strings;var prefix=$l.prefixAgo;var suffix=$l.suffixAgo;if(this.settings.allowFuture){if(distanceMillis<0){prefix=$l.prefixFromNow;suffix=$l.suffixFromNow;}}
if(!this.settings.allowPast&&distanceMillis>=0){return this.settings.strings.inPast;}
var seconds=Math.abs(distanceMillis)/1000;var minutes=seconds/60;var hours=minutes/60;var days=hours/24;var years=days/365;function substitute(stringOrFunction,number){var string=$.isFunction(stringOrFunction)?stringOrFunction(number,distanceMillis):stringOrFunction;var value=($l.numbers&&$l.numbers[number])||number;return string.replace(/%d/i,value);}
var words=seconds<45&&substitute($l.seconds,Math.round(seconds))||seconds<90&&substitute($l.minute,1)||minutes<45&&substitute($l.minutes,Math.round(minutes))||minutes<90&&substitute($l.hour,1)||hours<24&&substitute($l.hours,Math.round(hours))||hours<42&&substitute($l.day,1)||days<30&&substitute($l.days,Math.round(days))||days<45&&substitute($l.month,1)||days<365&&substitute($l.months,Math.round(days/30))||years<1.5&&substitute($l.year,1)||substitute($l.years,Math.round(years));var separator=$l.wordSeparator||"";if($l.wordSeparator===undefined){separator=" ";}
return $.trim([prefix,words,suffix].join(separator));},parse:function(iso8601){var s=$.trim(iso8601);s=s.replace(/\.\d+/,"");s=s.replace(/-/,"/").replace(/-/,"/");s=s.replace(/T/," ").replace(/Z/," UTC");s=s.replace(/([\+\-]\d\d)\:?(\d\d)/," $1$2");s=s.replace(/([\+\-]\d\d)$/," $100");return new Date(s);},datetime:function(elem){var iso8601=$t.isTime(elem)?$(elem).attr("datetime"):$(elem).attr("title");return $t.parse(iso8601);},isTime:function(elem){return $(elem).get(0).tagName.toLowerCase()==="time";}});var functions={init:function(){var refresh_el=$.proxy(refresh,this);refresh_el();var $s=$t.settings;if($s.refreshMillis>0){this._timeagoInterval=setInterval(refresh_el,$s.refreshMillis);}},update:function(time){var parsedTime=$t.parse(time);$(this).data('timeago',{datetime:parsedTime});if($t.settings.localeTitle)$(this).attr("title",parsedTime.toLocaleString());refresh.apply(this);},updateFromDOM:function(){$(this).data('timeago',{datetime:$t.parse($t.isTime(this)?$(this).attr("datetime"):$(this).attr("title"))});refresh.apply(this);},dispose:function(){if(this._timeagoInterval){window.clearInterval(this._timeagoInterval);this._timeagoInterval=null;}}};$.fn.timeago=function(action,options){var fn=action?functions[action]:functions.init;if(!fn){throw new Error("Unknown function name '"+action+"' for timeago");}
this.each(function(){fn.call(this,options);});return this;};function refresh(){var data=prepareData(this);var $s=$t.settings;if(!isNaN(data.datetime)){if($s.cutoff==0||Math.abs(distance(data.datetime))<$s.cutoff){$(this).text(inWords(data.datetime));}}
return this;}
function prepareData(element){element=$(element);if(!element.data("timeago")){element.data("timeago",{datetime:$t.datetime(element)});var text=$.trim(element.text());if($t.settings.localeTitle){element.attr("title",element.data('timeago').datetime.toLocaleString());}else if(text.length>0&&!($t.isTime(element)&&element.attr("title"))){element.attr("title",text);}}
return element.data("timeago");}
function inWords(date){return $t.inWords(distance(date));}
function distance(date){return(new Date().getTime()-date.getTime());}
document.createElement("abbr");document.createElement("time");}));!function(e,t){if("function"==typeof define&&define.amd)define(["exports","module"],t);else if("undefined"!=typeof exports&&"undefined"!=typeof module)t(exports,module);else{var o={exports:{}};t(o.exports,o),e.autosize=o.exports}}(this,function(e,t){"use strict";function o(e){function t(){var t=window.getComputedStyle(e,null);"vertical"===t.resize?e.style.resize="none":"both"===t.resize&&(e.style.resize="horizontal"),u="content-box"===t.boxSizing?-(parseFloat(t.paddingTop)+parseFloat(t.paddingBottom)):parseFloat(t.borderTopWidth)+parseFloat(t.borderBottomWidth),i()}
function o(t){var o=e.style.width;e.style.width="0px",e.offsetWidth,e.style.width=o,v=t,l&&(e.style.overflowY=t),n()}
function n(){var t=window.pageYOffset,o=document.body.scrollTop,n=e.style.height;e.style.height="auto";var i=e.scrollHeight+u;return 0===e.scrollHeight?void(e.style.height=n):(e.style.height=i+"px",document.documentElement.scrollTop=t,void(document.body.scrollTop=o))}
function i(){var t=e.style.height;n();var i=window.getComputedStyle(e,null);if(i.height!==e.style.height?"visible"!==v&&o("visible"):"hidden"!==v&&o("hidden"),t!==e.style.height){var r=document.createEvent("Event");r.initEvent("autosize:resized",!0,!1),e.dispatchEvent(r)}}
var r=void 0===arguments[1]?{}:arguments[1],d=r.setOverflowX,s=void 0===d?!0:d,a=r.setOverflowY,l=void 0===a?!0:a;if(e&&e.nodeName&&"TEXTAREA"===e.nodeName&&!e.hasAttribute("data-autosize-on")){var u=null,v="hidden",f=function(t){window.removeEventListener("resize",i),e.removeEventListener("input",i),e.removeEventListener("keyup",i),e.removeAttribute("data-autosize-on"),e.removeEventListener("autosize:destroy",f),Object.keys(t).forEach(function(o){e.style[o]=t[o]})}.bind(e,{height:e.style.height,resize:e.style.resize,overflowY:e.style.overflowY,overflowX:e.style.overflowX,wordWrap:e.style.wordWrap});e.addEventListener("autosize:destroy",f),"onpropertychange"in e&&"oninput"in e&&e.addEventListener("keyup",i),window.addEventListener("resize",i),e.addEventListener("input",i),e.addEventListener("autosize:update",i),e.setAttribute("data-autosize-on",!0),l&&(e.style.overflowY="hidden"),s&&(e.style.overflowX="hidden",e.style.wordWrap="break-word"),t()}}
function n(e){if(e&&e.nodeName&&"TEXTAREA"===e.nodeName){var t=document.createEvent("Event");t.initEvent("autosize:destroy",!0,!1),e.dispatchEvent(t)}}
function i(e){if(e&&e.nodeName&&"TEXTAREA"===e.nodeName){var t=document.createEvent("Event");t.initEvent("autosize:update",!0,!1),e.dispatchEvent(t)}}
var r=null;"undefined"==typeof window||"function"!=typeof window.getComputedStyle?(r=function(e){return e},r.destroy=function(e){return e},r.update=function(e){return e}):(r=function(e,t){return e&&Array.prototype.forEach.call(e.length?e:[e],function(e){return o(e,t)}),e},r.destroy=function(e){return e&&Array.prototype.forEach.call(e.length?e:[e],n),e},r.update=function(e){return e&&Array.prototype.forEach.call(e.length?e:[e],i),e}),t.exports=r});(function($){'use strict';var __=function(msgid){return window.i18n[msgid]||msgid;};window.Comments=function(element,options){this.element=element;this.options=$.extend({},Comments.defaults,options);this.initOptions();this.bindEvents();};Comments.defaults={storageKey:'comment_author',commentTemplateId:'commentTemplate',paginationTemplateId:'paginationTemplate',messages:{comment:'1 '+__('Comment'),comments:'{num} '+__('Comment'),nocomments:__('No comments yet'),error:'Opps!',},};Comments.prototype.initOptions=function(){var o=this.options,el=this.element;o.list=el.find('.list-comments');o.form=el.find('form');o.sort=el.find('.sort');o.total=el.find('.comment-total');o.placeholder=el.find('.placeholder');o.pagination=el.find('.pagination-container');o.currentPage=this.getParam('page',1);o.linkedComment=this.getParam('comment',0);$.ajaxSetup({headers:{'X-CSRF-TOKEN':this.options.csrfToken}});};Comments.prototype.bindEvents=function(){var o=this.options;o.placeholder.on('click',this.showForm.bind(this));o.form.find('.cancel').on('click',this.hideForm.bind(this));this.element.on('keyup','textarea',this.characterCount.bind(this));this.element.on('click','.captcha img',this.refreshCaptcha.bind(this));o.pagination.on('click','a',this.pageClick.bind(this));this.element.on('submit','.post-form',this.formSubmit.bind(this));o.sort.on('click','a',this.sort.bind(this));o.list.on('click','.reply',this.showReplyForm.bind(this));o.list.on('click','.time, .parent',this.setLinkedComment.bind(this));o.list.on('click','.collapse, .expand',this.toggleComment.bind(this));o.list.on('click','.like, .dislike',this.vote.bind(this));o.list.on('click','.quick-edit',this.showEditForm.bind(this));o.list.on('submit','.edit-form',this.submitEditForm.bind(this));o.list.on('click','.edit-form .cancel',this.hideEditForm.bind(this));o.list.on('click','.list-more',this.showComments.bind(this));o.list.on('click','.spoiler-btn',this.showSpoiler.bind(this));this.selectSort();this.loadComments();};Comments.prototype.showForm=function(e){this.getAuthor(this.options.form);this.options.placeholder.hide();this.options.form.show();autosize(this.options.form.find('textarea'));};Comments.prototype.hideForm=function(){this.options.form.hide();this.clearForm(this.options.form);this.options.placeholder.show();autosize.destroy(this.options.form.find('textarea'));};Comments.prototype.characterCount=function(e){var textarea=$(e.target),form=textarea.closest('form'),value=textarea.val(),maxlength=parseInt(textarea.attr('maxlength'))||0;if(!maxlength)return;if(value.length>maxlength){textarea.val(value.substr(0,maxlength));form.find('.character-count').text(0);}else{form.find('.character-count').text(maxlength-value.length);}};Comments.prototype.refreshCaptcha=function(){var images=this.element.find('.captcha img');if(!images.length)return;this.element.find('input[name="captcha"]').val('');this.ajax('GET','captcha',{}).done(function(src){images.attr('src',src);});};Comments.prototype.pageClick=function(e){e.preventDefault();var li=$(e.currentTarget).parent(),page=$(e.currentTarget).data('page');if(li.hasClass('disabled')||li.hasClass('active')){e.preventDefault();return false;}
window.location.hash='#!page='+page;$('body, html').animate({scrollTop:this.options.list.offset().top-20},400);this.options.currentPage=page;this.options.linkedComment=0;this.loadComments();}
Comments.prototype.formSubmit=function(e){e.preventDefault();var self=this,form=$(e.target),data=form.serialize(),list=this.options.list,depth=form.parents('.list-comment').length+1;if(form.find('input[name="parent_id"]').val().length){list=form.parent().parent().parent().next('.list-comments').first();}
form.find('.response').hide();this.disable(form);this.ajax('POST',data).done(function(comment){var $comment=self.renderComment(comment,null,depth);$comment.prependTo(list);self.highlight($comment);self.setTotal(self.options.total.data('total')+1);if(!comment.author.id){self.setAuthor($.extend(comment.author,{name:name}));}
form[0].reset();if(form.find('input[name="parent_id"]').val().length){form.find('.cancel').trigger('click');}}).fail(function(jqXHR){self.alert(jqXHR.responseJSON||self.trans('error'),form);}).always(function(){self.enable(form);});};Comments.prototype.sort=function(e){e.preventDefault();this.options.currentPage=1;this.options.linkedComment=0;this.options.sortBy=$(e.currentTarget).attr('data-sort');this.selectSort();this.loadComments();};Comments.prototype.selectSort=function(){this.options.sort.find('.current').text(this.options.sort.find('[data-sort="'+this.options.sortBy+'"]').text());this.options.sort.find('li').removeClass('selected');this.options.sort.find('[data-sort="'+this.options.sortBy+'"]').parent().addClass('selected');};Comments.prototype.loadComments=function(){var self=this,data={page:this.options.currentPage,content_id:this.options.content,type:this.options.type,linked:this.options.linkedComment,sort:this.options.sortBy,},toggleLoading=function(){self.element.find('.loader').toggle();};toggleLoading();this.ajax('GET','get',data).done(function(data){self.options.list.fadeOut(0,function(){self.options.list.html('');self.renderComments(data.comments,self.options.list);self.highlight(self.options.list);self.options.list.find('.list').show();self.options.list.fadeIn(0,function(){if(self.options.linkedComment){self.scrollToComment(self.options.linkedComment);}});});self.renderPagination(data);}).always(toggleLoading);};Comments.prototype.renderComments=function(comments,list,parent,depth){var i,$comment;depth=depth||1;for(i in comments){$comment=this.renderComment(comments[i],parent,depth);$comment.appendTo(list);if(comments[i].id===this.options.linkedComment){$comment.find('.linked').show();}
if(comments[i].replies){if(comments[i].replies.length>2){$('<a href="javascript:;" class="list-more" data-parent="'+comments[i].id+'">'+comments[i].replies.length+' <span>yanÄ±tÄ± gÃ¶rÃ¼ntÃ¼le</span> </a>').appendTo($comment.find('.list-comments'));}
if(!parent){comments[i].replies=this.hierarchical(comments[i].replies,comments[i].id);}
this.renderComments(comments[i].replies,$comment.find('.list-comments'),comments[i],depth+1);$comment.find('.list-comments').children('li:gt(1)').addClass('list-hide');}}};Comments.prototype.hierarchical=function(comments,parentId){var i,comment,result=[];for(i in comments){if(comments[i].parent_id===parentId){comment=comments[i];comment.replies=this.hierarchical(comments,comment.id);result.push(comment);}}
return result;};Comments.prototype.renderComment=function(comment,parent,depth){comment.parent=parent;comment.reply=this.options.replies;if(this.options.maxDepth&&depth>this.options.maxDepth){comment.reply=false;}
var $comment=this.renderTemplate(comment,this.options.commentTemplateId);$comment.find('.timeago').timeago();return $comment;}
Comments.prototype.renderPagination=function(data){this.setTotal(data.total?data.total:0);var pagination=data.pagination;if(!pagination||!pagination.per_page||pagination.total<=pagination.per_page){return;}
this.options.pagination.html(this.renderTemplate(pagination,this.options.paginationTemplateId));};Comments.prototype.setTotal=function(value){var total=value?(value===1?this.trans('comment'):this.trans('comments',{num:value})):this.trans('nocomments');var o=this.options;if(value==0){o.sort.hide();}else{o.sort.show();}
this.options.total.text(total).data('total',value).show();};Comments.prototype.toggleComment=function(e){$(e.currentTarget).closest('.list-comment').toggleClass('collapsed');}
Comments.prototype.vote=function(e){e.preventDefault();var UP='up',DOWN='down',REMOVE_UP='-up',REMOVE_DOWN='-down',type,$el=$(e.currentTarget),$votes=$el.parent(),$responseBox=$(e.currentTarget).parent().parent().parent().find('.replybox'),$upvote=$votes.find('.like'),$downvote=$votes.find('.dislike'),$upvotes=$votes.find('.likes'),$downvotes=$votes.find('.dislikes'),upvotes=parseInt($upvotes.data('votes')),downvotes=parseInt($downvotes.data('votes')),setUpvotes=function(val){$upvotes.data('votes',val).text(val||'');},setDownvotes=function(val){$downvotes.data('votes',val).text(val||'');};if(this.options.form.length===0){$responseBox.html(this.renderTemplate({message:'Yorum alanÄ± sadece Ã¼yelere Ã¶zeldir. <a href="'+_URL+'/oturum-ac">Oturum aÃ§</a> veya <a href="'+_URL+'/kaydol">Kaydol</a>'},'alertTemplate')).slideDown(200);return false;}
if($el.hasClass('like')){if($el.hasClass('voted')){$el.removeClass('voted');setUpvotes(upvotes-1);type=REMOVE_UP;}
else{type=UP;if($downvote.hasClass('voted')){$downvote.removeClass('voted');setDownvotes(downvotes-1);}
$el.addClass('voted');setUpvotes(upvotes+1);}}
else{if($el.hasClass('voted')){$el.removeClass('voted');setDownvotes(downvotes-1);type=REMOVE_DOWN;}
else{type=DOWN;if($upvote.hasClass('voted')){$upvote.removeClass('voted');setUpvotes(upvotes-1);}
$el.addClass('voted');setDownvotes(downvotes+1);}}
this.ajax('POST','vote',{id:$votes.closest('.list-comment').data('id'),type:type});};Comments.prototype.showReplyForm=function(e){e.preventDefault();var replybox=$(e.currentTarget).parent().parent().parent().find('.replybox'),rootId=$(e.currentTarget).data('id'),parentId=$(e.currentTarget).data('parent');if(replybox.html().length){return replybox.find('.cancel').trigger('click');}else if(this.options.form.length===0){replybox.html(this.renderTemplate({message:'Yorum alanÄ± sadece Ã¼yelere Ã¶zeldir. <a href="'+_URL+'/oturum-ac">Oturum aÃ§</a> veya <a href="'+_URL+'/kaydol">Kaydol</a>'},'alertTemplate')).slideDown(200);}
var form=this.options.form.clone();form.find('.cancel').bind('click',this.hideReplyForm.bind(this));this.clearForm(form);form.appendTo(replybox);form.find('input[name="parent_id"]').val(parentId);form.find('input[name="spoiler"]').attr('id',parentId);form.find('.custom-control-label').attr('for',parentId);this.getAuthor(form);form.show();autosize(form.find('textarea'));}
Comments.prototype.hideReplyForm=function(e){$(e.target).closest('form').remove();};Comments.prototype.showEditForm=function(e){e.preventDefault();var body=$(e.currentTarget).closest('.list-body'),form=body.find('.edit-form'),textarea=form.find('textarea');body.find('.text').hide();textarea.val(textarea.data('content'));form.show();autosize(textarea);};Comments.prototype.showComments=function(e){e.preventDefault();var moreBtn=e.currentTarget;if($(moreBtn).hasClass('less')){$(moreBtn).removeClass('less');$(moreBtn).find('span').text('yanÄ±tÄ± gÃ¶ster');$('.list-comments[data-parent="'+$(moreBtn).attr('data-parent')+'"]').children('li:gt(1)').addClass('list-hide');}else{$(moreBtn).addClass('less');$(moreBtn).find('span').text('yanÄ±tÄ± gizle');$('.list-comments[data-parent="'+$(moreBtn).attr('data-parent')+'"] li').removeClass('list-hide');}};Comments.prototype.showSpoiler=function(e){e.preventDefault();var target=$(e.currentTarget);var id=target.attr('data-id');target.hide();$('.list-comment[data-id="'+id+'"]').removeClass('spoiler');};Comments.prototype.hideEditForm=function(e){var body=$(e.currentTarget).closest('.list-body');body.find('.edit-form').hide();body.find('.text').show();}
Comments.prototype.submitEditForm=function(e){e.preventDefault();var self=this,form=$(e.target),data=form.serialize(),body=form.closest('.list-body'),text=body.find('.text'),decode=function(str){return $('<textarea/>').html(str).text();};form.find('.response').hide();this.disable(form);this.ajax('POST',data).done(function(comment){text.html(comment.comment);form.find('textarea').data('content',comment.comment);self.highlight(text);self.hideEditForm(e);if(comment.status!=='1'){body.find('.on-hold').addClass('show');body.find('.edit-menu').remove();}}).fail(function(jqXHR){self.alert(jqXHR.responseJSON||self.trans('error'),form);}).always(function(){self.enable(form);});}
Comments.prototype.clearForm=function(form){form.find('.response').hide();form.find('input[type="text"], textarea').val('');form.find('.character-count').text(form.find('textarea').attr('maxlength'));};Comments.prototype.setLinkedComment=function(e){e.preventDefault();var target=$(e.currentTarget);if(target.data('parent')){var comment=this.options.list.find('[data-id="'+target.data('parent')+'"]');}else{var comment=target.closest('.list-comment');}
window.location.hash='#!comment='+comment.data('id');this.options.list.find('.linked').hide();comment.find('.linked').first().show();}
Comments.prototype.scrollToComment=function(comment){if(!(comment instanceof $)){comment=this.options.list.find('[data-id="'+comment+'"]');}
if(comment.length){$('body, html').animate({scrollTop:comment.offset().top-20},100);}};Comments.prototype.alert=function(message,form){form.find('.response').html(this.renderTemplate({message:message},'alertTemplate')).fadeIn(0);};Comments.prototype.ajax=function(type,action,data){if(data){data.action=action;}else{data=action;}
return $.ajax({url:this.options.ajaxUrl,type:type,data:data,dataType:'json',});}
Comments.prototype.getParam=function(name,_default){var val,fragment=this.extractParam('_escaped_fragment_',location.search);if(fragment){val=this.extractParam(name,'#'+fragment,true);}else{val=this.extractParam(name,window.location.hash.replace('#!','#'),true);}
return parseInt(val)||_default;};Comments.prototype.extractParam=function(name,str,hash){name=name.replace(/[\[]/,'\\[').replace(/[\]]/,'\\]');var regex=new RegExp((hash?'[\\#]':'[\\?&]')+name+'=([^&#]*)'),results=regex.exec(str);if(results){return decodeURIComponent(results[1].replace(/\+/g,' '));}
return null;};Comments.prototype.setAuthor=function(author){author={name:author.name,email:author.email,url:author.url};window.localStorage.setItem(this.options.storageKey,JSON.stringify(author));};Comments.prototype.getAuthor=function($form){var author=window.localStorage.getItem(this.options.storageKey);try{author=JSON.parse(author);}catch(error){}
if(author){$form.find('input[name="author_name"]').val(author.name);$form.find('input[name="author_email"]').val(author.email);$form.find('input[name="author_url"]').val(author.url);}};Comments.prototype.renderTemplate=function(data,templateId){return $(tmpl(templateId,data));};Comments.prototype.trans=function(message,replace){message=this.options.messages[message]||message.toString();if(replace){$.each(replace,function(key,value){message=message.replace('{'+key+'}',value);});}
return message;};Comments.prototype.highlight=function($element){if(window.Prism){$('pre code').each(function(i,block){Prism.highlightElement(block);});}}
Comments.prototype.disable=function(form,state){state=(state===undefined)?true:state;form.find('button, input, textarea').prop('disabled',state);if($.fn.button){form.find('button[type="submit"]').button(state?'loading':'reset');}}
Comments.prototype.enable=function(form){this.disable(form,false);}})(jQuery);